---
title: "Faire parler le lecteur d'écran à l'aide de JavaScript et ARIA"
abstract: "Exemple de code permettant de faire parler la synthèse vocale grâce aux régions dynamiques ARIA."
titleBeforeTag: true
date: "2018-01-04"
tags:
  - component
js:
  - script.js
---

<p>Article mis à jour le ...</p>

<h2>Préambule</h2>
<p>Dans certaines interfaces, il peut être utile de faire annoncer automatiquement une information par un lecteur d'écran, par exemple pour confirmer une action ou signaler un changement dynamique. Cette fonctionnalité repose sur l'utilisation des <strong>régions dynamiques ARIA</strong> (<code>aria-live</code>) combinées à JavaScript.</p>

<h2>Principe de fonctionnement</h2>
<p>L'attribut <code>aria-live</code> appliqué à un élément indique au lecteur d'écran que les modifications de contenu doivent être annoncées automatiquement. Les valeurs principales sont :</p>
<ul>
  <li><code>aria-live="off"</code> : valeur par défaut, aucune annonce automatique.</li>
  <li><code>aria-live="polite"</code> : le message est annoncé dès que le lecteur d'écran est disponible, après avoir terminé sa lecture en cours.</li>
  <li><code>aria-live="assertive"</code> : le message interrompt immédiatement la lecture en cours pour être annoncé.</li>
</ul>
<p>Pour compléter le comportement, il est possible d'utiliser :</p>
<ul>
  <li><code>aria-atomic="true"</code> : indique que l'intégralité du contenu de l'élément doit être annoncée même si seule une partie change.</li>
  <li><code>aria-relevant="additions text removals"</code> : précise quel type de modification déclenche l'annonce.</li>
  <li>Les rôles <code>alert</code>, <code>status</code> ou <code>log</code> qui sont traités automatiquement comme des régions dynamiques.</li>
</ul>

<h2>Faire parler le lecteur d'écran avec JavaScript</h2>
<p>Il n'existe pas de fonction native pour faire parler directement le lecteur d'écran. Cependant, on peut créer une petite fonction JavaScript qui utilise une région dynamique ARIA sous le capot pour annoncer un message :</p>

<h2>Détail du code</h2>

<pre><code class="javascript">
/* announceToScreenReader(message, priority)
   message : le texte à vocaliser
   priority : "polite" (par défaut) ou "assertive" */

function announceToScreenReader(message, priority = "polite") {
    const region = document.createElement("div");
    const id = "sr-" + Date.now();

    region.setAttribute("id", id);
    region.setAttribute("aria-live", priority);
    region.setAttribute("aria-atomic", "true");
    region.classList.add("visually-hidden");

    document.body.appendChild(region);

    // Attendre un court délai pour que le lecteur d'écran détecte la région
    setTimeout(() => {
        region.textContent = message;
    }, 50);

    // Supprimer la région après annonce
    setTimeout(() => {
        document.body.removeChild(region);
    }, 2000);
}
</code></pre>

<p>Rappel : pour que les messages soient vocalisés mais pas visibles, vous devez avoir <a href="../masquage-accessible/">une classe de masquage accessible</a> (<code>visually-hidden</code>) dans vos <abbr>CSS</abbr>.</p>

<h2>Exemple interactif</h2>
<p>Vous pouvez tester cette fonction avec le formulaire ci-dessous (à tester avec un lecteur d'écran).</p>

<div class="mb-3">
  <label class="form-label" for="message">Message à vocaliser</label>
  <input type="text" id="message" class="form-control">
</div>
<button id="btnSpeak" class="btn btn-outline-secondary">Tester</button>
