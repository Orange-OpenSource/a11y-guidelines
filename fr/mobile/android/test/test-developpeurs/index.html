<!doctype html>
<html lang="fr" dir="ltr" class="no-js">
  <head>
    <meta charset="utf-8">
    <title>Tests des développeurs : analyse du code - Recommandations accessibilité numérique Orange</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://code.jquery.com" crossorigin="anonymous">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous">
    <link rel="preload" href="/assets/fonts/HelvNeue55_W1G.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/assets/fonts/HelvNeue75_W1G.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    
    <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" sizes="180x180">
    <link rel="icon" href="/assets/images/favicon-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/assets/images/favicon-16x16.png" sizes="16x16" type="image/png">
    <link rel="mask-icon" href="/assets/images/safari-pinned-tab.svg" color="#563d7c">
    <link rel="icon" href="/assets/images/favicon.ico">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boosted@4.5.3/dist/css/boosted.min.css" integrity="sha384-2x94UsUfEIjfJm4eAvt3wXrWUC/pAef/uLL2Q6KkHM9bgnm7fHaLTVOfjHlijBJS" crossorigin="anonymous">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.1/build/styles/a11y-light.min.css">
    
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/tarteaucitron-boosted.css"></head>
  <body data-spy="scroll" data-target="#toc" style="position:relative;">
    

<header role="banner">
  <div class="navbar navbar-dark navbar-expand supra">
    <div class="container-lg">
      <nav role="navigation" aria-label="Liens d&#39;évitements">
  <ul class="navbar-nav"><li class="nav-item">
        <a href="#main-menu" class="nav-link">Aller au menu</a>
      </li><li class="nav-item">
        <a href="#main-content" class="nav-link">Aller au contenu</a>
      </li><li class="nav-item">
        <a href="#footer" class="nav-link">Aller au pied de page</a>
      </li></ul>
</nav>

      <nav role="navigation" aria-label="Changement de langue">
  <ul class="navbar-nav">
      <li class="nav-item">
        <a href="/en/" class="nav-link" lang="en">
        English
        </a>
      </li>
      <li class="nav-item">
        <a href="/fr/" class="nav-link active" aria-current="true" lang="fr">
        Français
        </a>
      </li></ul>
</nav>
    </div>
  </div>
  

<div class="navbar navbar-dark navbar-expand-md">
  <nav id="main-menu" class="container-lg justify-content-md-start" role="navigation" aria-label="Navigation principale">
    <a href="/fr" class="navbar-brand" title="Orange, aller à l’accueil">
      <img src="/assets/images/orange-logo.svg" alt="Orange, aller à l’accueil" width="50" height="50">
    </a>

    <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#main-menu-list" aria-controls="main-menu-list" aria-expanded="false" aria-label="Menu de navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <ul id="main-menu-list" class="navbar-nav navbar-collapse collapse"><li class="nav-item">
          <a href="/fr/" class="nav-link">
  Accueil
</a>
        </li><li class="nav-item">
          <a href="/fr/cadrage/" class="nav-link">
  Cadrage
</a>
        </li><li class="nav-item">
          <a href="/fr/web/" class="nav-link">
  Web
</a>
        </li><li class="nav-item">
          <a href="/fr/mobile/android/" class="nav-link active" aria-current="true">
  Android
</a>
        </li><li class="nav-item">
          <a href="/fr/mobile/ios/" class="nav-link">
  iOS
</a>
        </li><li class="nav-item">
          <a href="/fr/contenu-editorial/" class="nav-link">
  Contenu éditorial
</a>
        </li><li class="nav-item">
          <a href="/fr/articles/" class="nav-link">
  Articles
</a>
        </li><li class="nav-item d-md-none">
  <span class="sr-only">Changement de langue</span>
  <ul class="d-flex list-inline">
      <li class="list-inline-item flex-grow-1">
        <a href="/en/" class="nav-link" lang="en">
        English
        </a>
      </li>
      <li class="list-inline-item flex-grow-1">
        <a href="/fr/" class="nav-link active" aria-current="true" lang="fr">
        Français
        </a>
      </li></ul>
</li>
    </ul>
  </nav>
</div>

  <nav id="secondary-navigation" class="o-nav-local navbar-light mb-1" role="navigation" aria-label="Navigation secondaire">
  <div class="container-lg">
    <ul class="nav"><li class="nav-item">
              <a href="/fr/mobile/android/conception/" class="nav-link">
  Designer
</a>
            </li><li class="nav-item">
              <a href="/fr/mobile/android/developpement/" class="nav-link">
  Développer
</a>
            </li><li class="nav-item">
              <a href="/fr/mobile/android/test/" class="nav-link active" aria-current="true">
  Tester
</a>
            </li><li class="nav-item">
              <a href="/fr/mobile/android/outils/" class="nav-link">
  Boite à outils
</a>
            </li></ul>
  </div>
</nav>
</header>

    <div class="container-lg pt-2">
      
      
        

<nav role="navigation" aria-labelledby="breadcrumb-label">
  <p id="breadcrumb-label" class="sr-only">Vous êtes ici&amp;nbsp;:</p>
  <ol class="breadcrumb">
      
        <li class="breadcrumb-item d-none d-sm-flex">
          <a href="/fr/">Accueil</a>
        </li>
      
      
        <li class="breadcrumb-item d-none d-sm-flex">
          <a href="/fr/mobile/android/">Android</a>
        </li>
      
      
        <li class="breadcrumb-item">
          <a href="/fr/mobile/android/test/">Tester</a>
        </li>
      
      
        <li class="breadcrumb-item d-none d-sm-flex" aria-current="location">
          Tests des développeurs : analyse du code
        </li>
      </ol>
</nav>

      
      <div class="MobileDropdownNavigationContainer d-flex flex-column flex-sm-row justify-content-between">
        <nav id="mobile-side-navigation" class="dropdown d-md-none" role="navigation" aria-labelledby="mobile-side-navigation-handler">
      <button type="button" class="btn btn-secondary dropdown-toggle" id="mobile-side-navigation-handler" data-toggle="dropdown" aria-expanded="false">
        Thématiques
      </button>
      <div class="dropdown-menu dropdown-menu-left"><a href="/fr/mobile/android/test/test-developpeurs/" class="nav-link dropdown-item active" aria-current="page">
  Tests des développeurs : analyse du code
</a><a href="/fr/mobile/android/test/outils-analyse/" class="nav-link dropdown-item">
  Scan de l&#39;application : les outils d&#39;analyse
</a><a href="/fr/mobile/android/test/test-manuel/" class="nav-link dropdown-item">
  Les tests manuels : mise en situation
</a></div>
    </nav>
        
          <nav id="mobile-toc" class="dropdown d-md-none" role="navigation" aria-labelledby="mobile-toc-dropdown-handler">
      <button type="button" class="btn btn-secondary dropdown-toggle" id="mobile-toc-dropdown-handler" data-toggle="dropdown" aria-expanded="false">
        Sommaire
      </button>
      <div class="dropdown-menu dropdown-menu-right"><a href="#lint" class="dropdown-item text-wrap">Lint</a><a href="#tests-automatises-espresso" class="dropdown-item text-wrap">Tests automatisés : Espresso</a><a href="#realiser-les-tests-automatises-daccessibilite-sur-lensemble-de-lecran" class="dropdown-item text-wrap">Réaliser les tests automatisés d’accessibilité sur l’ensemble de l’écran</a><a href="#loguer-les-erreurs-daccessibilite-plutot-que-de-provoquer-lechec-des-tests" class="dropdown-item text-wrap">Loguer les erreurs d’accessibilité plutôt que de provoquer l&#39;échec des tests</a><a href="#creer-une-whitelist" class="dropdown-item text-wrap">Créer une whitelist</a></div>
    </nav>
        
      </div>
    </div>
    
  <div class="container-lg pt-4">
      <div class="row">
        
          <div class="col-md-3">
            <div class="StickySideNavigation">
              <nav id="side-navigation" class="d-none d-md-block" role="navigation" aria-labelledby="side-navigation-label">
      <h2 id="side-navigation-label">Thématiques</h2>
      <ul class="nav flex-column"><li class="nav-item position-relative">
            <a href="/fr/mobile/android/test/test-developpeurs/" class="nav-link text-muted active" aria-current="page">
  Tests des développeurs : analyse du code
</a>
          </li><li class="nav-item position-relative">
            <a href="/fr/mobile/android/test/outils-analyse/" class="nav-link text-muted">
  Scan de l&#39;application : les outils d&#39;analyse
</a>
          </li><li class="nav-item position-relative">
            <a href="/fr/mobile/android/test/test-manuel/" class="nav-link text-muted">
  Les tests manuels : mise en situation
</a>
          </li></ul>
    </nav>
              
            </div>
          </div>
        
        <main id="main-content" class="col-md-6" role="main">
          <h1>Tests des développeurs : analyse du code</h1>
<p>Cette étape permet de remonter directement des problèmes d’accessibilité pendant la phase de développement et provoque des erreurs de build de l’application, ou divers warnings. Le développeur doit ainsi les corriger directement pour pouvoir builder son application et la faire fonctionner, ce qui la rend d’office plus accessible avant même de la faire passer par des tests manuels, ou par des outils d’analyse. De plus, cela évite les possibles régressions d’accessibilité.</p>
<h2 id="lint"><span lang="en">Lint</span> <a class="header-anchor" href="#lint" aria-labelledby="a11y_heading_anchor_label">#</a></h2>
<p>Le développeur peut en premier lieu utiliser l’outil <span lang="en">Lint</span> dans Android Studio, sur son application, afin de faire une première passe sur les problèmes d’accessibilités.<br>
5 problèmes d’accessibilités peuvent être remontés grâce à <span lang="en">Lint</span> :</p>
<ul>
<li><strong><span lang="en">ClickableViewAccessibility </span></strong>: Si une vue surcharge  <span lang="en">onTouchEvent </span> ou utilise une surcharge <span lang="en">onTouchListener</span> , mais n’implémente pas <span lang="en">performClick</span></li>
<li><strong><span lang="en">ContentDescription</span></strong> : les widgets non textuels ne portant aucune <span lang="en">contentDescription</span></li>
<li><strong><span lang="en">KeyboardInaccessibleWidget</span></strong> : les widgets étant déclarés comme clickables mais non focusables.</li>
<li><strong><span lang="en">LabelFor</span></strong> : un <span lang="en">EditText</span> doit contenir soit un <span lang="en">hint</span>, soit la référence d’un label associé avec <span lang="en">labelFor</span></li>
<li><strong><span lang="en">GetContentDescriptionOverride</span></strong> : surcharger <span lang="en">getContentDescription</span> peut poser des problèmes d’accès aux services d’accessibilité. Dans le cas où on a besoin de modifier la description, il faut plutôt faire appel à la fonction : <span lang="en">setContentDescription</span></li>
</ul>
<p><strong>Exemple de rapport Lint sous Android Studio :</strong></p>
<img src="../../../images/lint.png" alt="capture d’écran présentant un rapport de l'outil Lint, qui affiche une erreur d'accessibilité" width="80%">
<h2 id="tests-automatises-espresso">Tests automatisés : Espresso <a class="header-anchor" href="#tests-automatises-espresso" aria-labelledby="a11y_heading_anchor_label">#</a></h2>
<p>Espresso est un framework permettant de tester son UI sous Android. On peut alors y intégrer le framework ATF (<span lang="en">Accessibility Test Framework</span>), qui va ajouter une couche de tests concernant l’accessibilité.</p>
<p>Aucun test explicite n’a besoin d’être écrit. Une fois ATF intégré aux tests Expresso, les vérifications d’accessibilité se rajoutent automatiquement. ATF fonctionne cependant avec les <span lang="en">ViewAction</span>, c’est-à-dire qu’il va effectuer automatiquement la vérification d’accessibilité sur les interactions <span lang="en">ViewAction</span> mis en place dans les tests Espresso. De plus, pour activer les vérifications d’accessibilité, il faut faire appel à la fonction <code>AccessibilityChecks.enable()</code> dans la suite de tests.</p>
<p>Voici comment l’intégrer :</p>
<pre>
<code class="java">
@Before
    public static void enableAccessibilityChecks() {
        AccessibilityChecks.enable();
    }
</code></pre>
<pre>
<code class="kotlin">
companion object {
    @BeforeClass @JvmStatic
    fun enableAccessibilityChecks() {
        AccessibilityChecks.enable()
    }
}
</code></pre>
<p>C’est ainsi que, dans le cas où l’on réalise dans la suite de test un <code>ViewAction.click()</code> sur un bouton qui ne correspond pas à la taille requise pour un élément interactif, le test apparaitra en erreur jusqu’à ce que le problème d’accessibilité soit résolu.</p>
<h3 id="realiser-les-tests-automatises-daccessibilite-sur-lensemble-de-lecran">Réaliser les tests automatisés d’accessibilité sur l’ensemble de l’écran <a class="header-anchor" href="#realiser-les-tests-automatises-daccessibilite-sur-lensemble-de-lecran" aria-labelledby="a11y_heading_anchor_label">#</a></h3>
<p>L’automatisation du test d’accessibilité selon les <span lang="en">ViewAction</span> peut cependant devenir limitant. C’est pourquoi, on peut indiquer lors de l’activation de ATF, que l’on souhaite faire les validations depuis la vue racine. Ainsi, toutes les vues seront testées, sans besoin d’ajouter de <span lang="en">ViewActions</span>. Pour ce faire, il faut remplacer  <code>AccessibilityChecks.enable()</code> par <code>AccessibilityChecks.enable().setRunChecksFromRootView(true)</code></p>
<h3 id="loguer-les-erreurs-daccessibilite-plutot-que-de-provoquer-lechec-des-tests">Loguer les erreurs d’accessibilité plutôt que de provoquer l'échec des tests <a class="header-anchor" href="#loguer-les-erreurs-daccessibilite-plutot-que-de-provoquer-lechec-des-tests" aria-labelledby="a11y_heading_anchor_label">#</a></h3>
<p>Il est possible de loguer les erreurs d’accessibilité afin de les voir apparaitre dans le logcat d’Android Studio, plutôt que de provoquer l'échec des tests Espresso, même si cela n’est pas conseillé. Cela ne doit être utilisé que dans un cadre temporaire. Pour ce faire, il faut ajouter la fonction suivante : <code>AccessibilityChecks.enable().setThrowExceptionForErrors(false)</code></p>
<h3 id="creer-une-whitelist">Créer une whitelist <a class="header-anchor" href="#creer-une-whitelist" aria-labelledby="a11y_heading_anchor_label">#</a></h3>
<p>Plutôt que d'afficher toutes les erreurs d’accessibilité dans le logcat, il est possible de créer une <span lang="en">whitelist</span> pour ne loguer que celles que l’on souhaite, tout en conservant les autres en erreur. Pour cela, il faut ajouter la fonction suivante :<br>
<code>AccessibilityChecks.enable().setRunChecksFromRootView(true).setSuppressingResultMatcher(matchesView(anyOf(withId(R.id.buttonPlus))))</code></p>
<p>Dans cet exemple, la vue ayant pour id <strong><span lang="en">buttonPlus</span></strong> ne sera pas indiquée en erreur en cas de problème d’accessibilité, mais sera affichée dans le logcat.</p>
<p><span class="licence" lang="en">These images are licensed under a Creative Commons Share Alike 2.0 license. Photo credit: <a href="http://www.flickr.com/people/27512715@N02/" hreflang="en">openexhibits</a></span></p>

        </main>
        
          <div class="col-md-3">
            <div class="StickySideNavigation">
              <nav id="toc" class="bg-200 p-3 d-none d-md-block" role="navigation" aria-labelledby="toc-title">
      <h2 id="toc-title">Sommaire</h2>
      <ul class="nav flex-column"><li class="nav-item position-relative">
            <a href="#lint" class="nav-link text-muted bg-200">Lint</a>
          </li><li class="nav-item position-relative">
            <a href="#tests-automatises-espresso" class="nav-link text-muted bg-200">Tests automatisés : Espresso</a>
          </li><li class="nav-item position-relative">
            <a href="#realiser-les-tests-automatises-daccessibilite-sur-lensemble-de-lecran" class="nav-link text-muted bg-200">Réaliser les tests automatisés d’accessibilité sur l’ensemble de l’écran</a>
          </li><li class="nav-item position-relative">
            <a href="#loguer-les-erreurs-daccessibilite-plutot-que-de-provoquer-lechec-des-tests" class="nav-link text-muted bg-200">Loguer les erreurs d’accessibilité plutôt que de provoquer l&#39;échec des tests</a>
          </li><li class="nav-item position-relative">
            <a href="#creer-une-whitelist" class="nav-link text-muted bg-200">Créer une whitelist</a>
          </li></ul>
    </nav>
            </div>
          </div>
        
      </div>
    </div>
    <footer id="footer" class="o-footer" role="contentinfo">
  <div class="container-lg">
    <nav class="py-2" role="navigation">
      <ul class="nav flex-column flex-sm-row"><li class="nav-item">
            <a href="/fr/contact" class="nav-link"><u>Contact</u></a>
          </li><li class="nav-item">
            <a href="/fr/a-propos" class="nav-link"><u>À propos</u></a>
          </li><li class="nav-item ml-sm-auto">
          <a href="https://github.com/Orange-OpenSource/a11y-guidelines/issues/new?title=File%20path%20:%20'./src/fr/mobile/android/test/test-developpeurs.md'" class="nav-link" rel="noopener noreferrer" target="_blank" title="Signaler une erreur sur Github (nouvelle fenêtre)">
            <u>Signaler une erreur sur Github<span class="sr-only">&nbsp;(nouvelle fenêtre)</span><svg width="16" height="16" class="ml-1" viewBox="0 0 1000 1000" aria-hidden="true" focusable="false"><path class="cls-1" d="M374.908,308.958L600,309V109L921.719,430.9a74.988,74.988,0,0,1,0,106.044L600,859V659H325A150.027,150.027,0,0,0,175,809v81C98.941,830.528,50,737.929,50,633.891,50,454.436,195.466,308.958,374.908,308.958Z"/></svg></u>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</footer>

    <a href="#" id="back-to-top" class="o-scroll-up static" title="Retour en haut de page">
      <span class="d-none d-sm-inline-block">Retour en haut de page</span>
    </a>
    <script src="/assets/vendors/tarteaucitronjs/tarteaucitron.js"></script>
    
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    
    
      <script src="https://cdn.jsdelivr.net/npm/boosted@4.5.3/dist/js/boosted.min.js" integrity="sha384-dZ5yFPu4JLOG6APRar263bUkZl+uDJl2LWBDXvSyVocYb4g2FJrT0BxpETyjdqtj" crossorigin="anonymous"></script>
    
    
    
      <script src="/assets/vendors/highlightjs/highlight.js"></script>
    
    <script>
      const Application = {
        lang: "fr",
        vendors: {
          highlightJS: true
        }
      }
    </script>
    <script src="/assets/script.js"></script><script>
      var tarteaucitronForceLanguage = "fr"
      tarteaucitron.init({"privacyUrl":"","hashtag":"#cookie-consent","cookieName":"cookie-consent","orientation":"bottom","showAlertSmall":false,"cookieslist":true,"adblocker":false,"AcceptAllCta":true,"highPrivacy":true,"handleBrowserDNTRequest":false,"removeCredit":false,"moreInfoLink":true,"useExternalCss":true,"readmoreLink":"/cookiespolicy","mandatory":false});var dataLayer = [{
          'site_name': 'accessibility-guidelines',
          'phase': 'prod'
        }];
        tarteaucitron.user.googletagmanagerId = "GTM-N3M5VXS";
        (tarteaucitron.job = tarteaucitron.job || []).push('googletagmanager')</script>
    <div id="a11y_heading_anchor_label" hidden>Lien pour ancrage</div>
    <!--  This file is part of a11y-guidelines | Our vision of mobile & web accessibility guidelines and best practices, with valid/invalid examples. Copyright (C) 2016 - 2020 Orange SA. See the Creative Commons Legal Code Attribution-ShareAlike 3.0 Unported License for more details (LICENSE file). -->

  </body>
</html>
