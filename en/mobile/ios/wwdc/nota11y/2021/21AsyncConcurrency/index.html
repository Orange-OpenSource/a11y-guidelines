<!doctype html>
<html lang="en" dir="ltr" class="no-js" data-bs-theme="light">
  <head>
    <meta charset="utf-8">
    <title>Asynchronicity and concurrency in iOS 15 - Orange digital accessibility guidelines</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="l2y2kYf6v887K8NW7L41pN29ueW0w5P02MJrUiP2JoA" />
    
    <link rel="preconnect" href="https://code.jquery.com" crossorigin="anonymous">
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin="anonymous">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous">
    <link rel="preload" href="/assets/fonts/HelvNeue55_W1G.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/assets/fonts/HelvNeue75_W1G.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="alternate" type="application/rss+xml" title="Recommandations accessibilité Orange - Français" href="/feed-fr.xml" />
    <link rel="alternate" type="application/rss+xml" title="Orange digital accessibility guidelines - English" href="/feed-en.xml" />
    
    <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" sizes="180x180">
    <link rel="icon" href="/assets/images/favicon-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="/assets/images/favicon-16x16.png" sizes="16x16" type="image/png">
    <link rel="mask-icon" href="/assets/images/safari-pinned-tab.svg" color="#563d7c">
    <link rel="icon" href="/assets/images/favicon.ico">
    
    <link href="https://cdn.jsdelivr.net/npm/boosted@5.3.3/dist/css/boosted.min.css" rel="stylesheet" integrity="sha384-laZ3JUZ5Ln2YqhfBvadDpNyBo7w5qmWaRnnXuRwNhJeTEFuSdGbzl4ZGHAEnTozR" crossorigin="anonymous">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.1/build/styles/a11y-light.min.css">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    <link rel="stylesheet" href="/assets/style.css">
    <link rel="stylesheet" href="/assets/tarteaucitron-boosted.css"></head>
  <body data-bs-spy="scroll" data-bs-offset="130" data-bs-target="#toc" style="position:relative;">
    

<header role="banner">
  <nav class="navbar navbar-expand-lg supra" aria-label="Skip links - Switch language" data-bs-theme="dark">
   <div class="container-lg">
      <ul id="avoidanceLinks" class="navbar-nav me-auto"><li class="nav-item">
      <a href="#main-menu" class="nav-link">Go to menu</a>
    </li><li class="nav-item">
      <a href="#main-content" class="nav-link">Go to content</a>
    </li><li class="nav-item hidden-if-no-js">
      <a href="#search-input" class="nav-link">Go to search</a>
    </li><li class="nav-item">
      <a href="#footer" class="nav-link">Go to footer</a>
    </li></ul>

      <ul class="navbar-nav">
      <li class="nav-item">
        <a href="/en/" class="nav-link active" aria-current="true" lang="en">
        English
        </a>
      </li>
      <li class="nav-item">
        <a href="/fr/" class="nav-link" lang="fr">
        Français
        </a>
      </li></ul>
    </div>
  </nav>

  

<div class="navbar navbar-expand-md" data-bs-theme="dark">
  <nav id="main-menu" class="container-lg justify-content-md-start align-items-center" role="navigation" aria-label="Main navigation">
    <a href="/en/" class="navbar-brand flex-grow-1 flex-md-grow-0" title="Orange, go to homepage">
      <img src="/assets/images/orange-logo.svg" alt="Orange, go to homepage" width="50" height="50">
    </a>

    <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#main-menu-list" aria-controls="main-menu-list" aria-expanded="false" aria-label="Navigation menu">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse me-auto" id="main-menu-list">
      <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a href="/en/" class="nav-link">
  Home
</a>
            </li>
            <li class="nav-item">
              <a href="/en/planning/" class="nav-link">
  Planning
</a>
            </li>
            <li class="nav-item">
              <a href="/en/web/" class="nav-link">
  Web
</a>
            </li>
            <li class="nav-item">
              <a href="/en/mobile/android/" class="nav-link">
  Android
</a>
            </li>
            <li class="nav-item">
              <a href="/en/mobile/ios/" class="nav-link active" aria-current="true">
  iOS
</a>
            </li>
            <li class="nav-item">
              <a href="/en/content-and-communication/" class="nav-link">
  Content and communication
</a>
            </li>
            <li class="nav-item">
              <a href="/en/articles/" class="nav-link">
  Articles
</a>
            </li><li class="nav-item d-md-none">
  <span class="visually-hidden">Switch language</span>
  <ul class="d-flex list-inline">
      <li class="list-inline-item flex-grow-1">
        <a href="/en/" class="nav-link active" aria-current="true" lang="en">
        English
        </a>
      </li>
      <li class="list-inline-item flex-grow-1">
        <a href="/fr/" class="nav-link" lang="fr">
        Français
        </a>
      </li></ul>
</li>
      </ul>
    </div>

    <div id="search-input"></div>

  </nav>
</div>

  <nav id="secondary-navigation" class="o-nav-local border-bottom border-light navbar-light mb-1" role="navigation" aria-label="Secondary navigation">
  <div class="container-lg">
    <ul class="nav"><li class="nav-item">
              <a href="/en/mobile/ios/design/" class="nav-link">
  Design
</a>
            </li><li class="nav-item">
              <a href="/en/mobile/ios/development/" class="nav-link">
  Develop
</a>
            </li><li class="nav-item">
              <a href="/en/mobile/ios/test/" class="nav-link">
  Test
</a>
            </li><li class="nav-item">
              <a href="/en/mobile/ios/wcag-audit/" class="nav-link">
  Audit
</a>
            </li><li class="nav-item">
              <a href="/en/mobile/ios/toolbox/" class="nav-link">
  Toolbox
</a>
            </li><li class="nav-item">
              <a href="/en/mobile/ios/checklist/" class="nav-link">
  11 Essentials
</a>
            </li><li class="nav-item">
              <a href="/en/mobile/ios/wwdc/" class="nav-link active" aria-current="true">
  WWDC
</a>
            </li></ul>
  </div>
</nav>
</header>
    <div class="container-lg pt-2">
      
      
        

<nav role="navigation" aria-labelledby="breadcrumb-label">
  <p id="breadcrumb-label" class="visually-hidden">You are here:</p>
  <ol class="breadcrumb">
      
        <li class="breadcrumb-item d-none d-sm-flex">
          <a class="breadcrumb-focus" href="/en/">Home</a>
        </li>
      
      
        <li class="breadcrumb-item d-none d-sm-flex">
          <a class="breadcrumb-focus" href="/en/mobile/ios/">iOS</a>
        </li>
      
      
        <li class="breadcrumb-item">
          <a class="breadcrumb-focus" href="/en/mobile/ios/wwdc/">WWDC</a>
        </li>
      
      
        <li class="breadcrumb-item d-none d-sm-flex" aria-current="page">
          Asynchronicity and concurrency in iOS 15
        </li>
      </ol>
</nav>

      
      <div class="MobileDropdownNavigationContainer d-flex flex-column flex-sm-row justify-content-between">
        
        
          <nav id="mobile-toc" class="dropdown d-md-none" role="navigation" aria-labelledby="mobile-toc-dropdown-handler">
      <button type="button" class="btn btn-outline-secondary dropdown-toggle" id="mobile-toc-dropdown-handler" data-bs-toggle="dropdown" aria-expanded="false">
        On this page
      </button>
      <div class="dropdown-menu dropdown-menu-right"><a href="#swift-concurrency" class="dropdown-item text-wrap">Swift Concurrency</a><a href="#async-await" class="dropdown-item text-wrap">Async-await</a><a href="#tasks" class="dropdown-item text-wrap">Tasks</a><a href="#async-let" class="dropdown-item text-wrap">Async-let</a><a href="#group" class="dropdown-item text-wrap">Group</a><a href="#unstructured" class="dropdown-item text-wrap">Unstructured</a><a href="#detached" class="dropdown-item text-wrap">Detached</a><a href="#actors" class="dropdown-item text-wrap">Actors</a><a href="#isolation" class="dropdown-item text-wrap">Isolation</a><a href="#sendable" class="dropdown-item text-wrap">Sendable</a><a href="#main-actor" class="dropdown-item text-wrap">Main actor</a></div>
    </nav>
        
      </div>
    </div>
    
  <div class="container-lg pt-4">
      <div class="row">
        
        <main id="main-content" class="col-md-9" role="main">
          
          <div class="mt-4">
          <h1>WWDC 2021: Asynchronicity and concurrency in iOS 15</h1>
<p>Find hereafter a detailed summary of four videos that belong to a <a href="../../">taxonomy of some WWDC footages</a>.</p>
<p>The original videos are available on the <strong>official Apple website</strong> (<a href="https://developer.apple.com/videos/play/wwdc2021/10133/">session 10133</a>,  <a href="https://developer.apple.com/videos/play/wwdc2021/10132/">session 10132</a>,  <a href="https://developer.apple.com/videos/play/wwdc2021/10134/">session 10134</a> and  <a href="https://developer.apple.com/videos/play/wwdc2021/10254/">session 10254</a>).</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Intro.png" alt="" class="img-fluid"></p>
<p>&quot;Data races occur when two separate threads concurrently access the same mutable state. They are trivial to construct, but are notoriously hard to debug. Discover how you can <strong>stop these data races</strong> in their tracks <strong>with Swift actors</strong>, which help synchronize access to data in your code. Discover how actors work and how to share values between them. Learn about how <strong>actor isolation</strong> affects protocol conformances. And finally, meet the <strong>main actor</strong>, a new way of ensuring that your code always runs on the main thread when needed.&quot;</p>
<p>&quot;Swift now supports <strong>asynchronous functions</strong> — a pattern commonly known as async/await. Discover how the <strong>new syntax</strong> can make your code easier to read and understand. Learn what happens when a function suspends, and find out how to <strong>adapt existing completion handlers to asynchronous functions</strong>.&quot;</p>
<p>&quot;When you have code that needs to run at the same time as other code, it's important to choose the right tool for the job. We'll take you through the different kinds of <strong>concurrent tasks</strong> you can create in Swift, show you how to create <strong>groups of tasks</strong>, and find out how to <strong>cancel tasks in progress</strong>. We'll also provide guidance on when you may want to use <strong>unstructured tasks</strong>.&quot;</p>
<p>&quot;Dive into the details of <strong>Swift concurrency</strong> and discover how Swift provides greater safety from data races and thread explosion while simultaneously improving performance. We'll explore how <strong>Swift tasks</strong> differ from Grand Central Dispatch, how the <strong>new cooperative threading model</strong> works, and how to ensure the best performance for your apps.&quot;<br>
</br><br>
The various contents of this speech are indicated hereunder:</p>
<ul>
<li>
<p><a href="#swift-concurrency">Swift Concurrency</a></p>
</li>
<li>
<p><a href="#async-await">Async-await</a></p>
</li>
<li>
<p><a href="#tasks">Tasks</a></p>
</li>
<li>
<p><a href="#actors">Actors</a></p>
</li>
</ul>
<p></br>Most of the illustrations are parts of the Apple presentations and may be available at the <code>Resources</code> section inside the <code>Overview</code> sheet of each video.<br>
</br>Hereafter, the underlined elements lead directly to the playback of the WWDC video at the appropriate moment.<br>
</br></p>
<h2 id="swift-concurrency" class="h2-focus">Swift Concurrency <a class="header-anchor" href="#swift-concurrency" id="heading-1814" aria-labelledby="heading-1814">#</a></h2>
<p>In order to improve the efficiency at different levels, the usual Grand Central Dispatch process has moved to the <strong>new Concurrency Model</strong> in <strong>iOS 15</strong> including:</p>
<ul>
<li>
<p>A <strong>cooperative thread pool</strong>.</p>
</li>
<li>
<p>The <strong><a href="#async-await">async/await syntax</a></strong> that lets the compiler and the runtime be aware of a piece of code might suspend and resume execution while never using escaping closures as callbacks anymore.</p>
</li>
<li>
<p>A <strong>structured concurrency</strong> based on the<button class="btn btn-link" onclick="tabPanelFocus('TasksAsyncLetTaskTree_tab','TasksAsyncLetTaskTree')">task tree</button>with a hierachical approach with a parent task and a given priority of execution.<br>
</br></p>
</li>
</ul>
<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active"
           data-bs-toggle="tab" 
           href="#SwiftConcurrencyThreads"
           id="SwiftConcurrencyThreads_tab"
           role="tab" 
           aria-selected="true">Threads</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#SwiftConcurrencyContinuation"
           id="SwiftConcurrencyContinuation_tab"
           role="tab" 
           aria-selected="false">Continuation</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#SwiftConcurrencyExample"
           id="SwiftConcurrencyExample_tab"
           role="tab" 
           aria-selected="false">Example</a>
    </li>
</ul>
<div class="tab-content">
<div class="tab-pane show active" id="SwiftConcurrencyThreads" role="tabpanel">
<p>Spawning a <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=506">huge amount of threads</a> may lead to dangerous situations.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-SwiftConcurrencyThreads_1.png" alt="" class="img-fluid"></p>
<p>A <strong>new <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=1239">cooperative thread pool</a></strong> has been introduced to ensure the number of created threads doesn’t exceed the number of CPU cores available.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-SwiftConcurrencyThreads_2.png" alt="" class="img-fluid"></p>
<p>It's recommended to activate the dedicated <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=1611">environment variable</a> that points out the use of an unsafe blocking primitive under a debug runtime.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-SwiftConcurrencyThreads_3.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="SwiftConcurrencyContinuation" role="tabpanel">
<p>The power of concurrency relied on the <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=611">timesharing</a> that could unfortunately lead to  in tough situations due to the context switches processing the results.<br>
These thread context switches are <strong>replaced by the continuations</strong> for managing the <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=671">resumption of work</a>.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-SwiftConcurrencyContinuation_1.png" alt="" class="img-fluid"></p>
<p>A <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=1126">continuation</a> is the <strong>block of code that runs after the await</strong> and is put back on a thread’s stack when execution should resume.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-SwiftConcurrencyContinuation_2.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="SwiftConcurrencyExample" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=791">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-SwiftConcurrencyExample.png" alt="" class="img-fluid"></p>
</div>
</div>
</br></br>
<p>Serialization and avoidance of data races are ensured by the <strong>Actor protocol</strong> detailed in the <a href="#actors">devoted part</a>.<br>
</br></br></p>
<h2 id="async-await" class="h2-focus"><a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=28">Async-await</a> <a class="header-anchor" href="#async-await" id="heading-1815" aria-labelledby="heading-1815">#</a></h2>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-Intro.png" alt="" class="img-fluid"></p>
<p>Based on the differences between functions that are <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=982">async</a> or <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=919">not</a>, the <code>async-await</code> syntax can also be <strong>applied to <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=796">properties</a></strong> that can thus behave asynchronously.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-Properties.png" alt="" class="img-fluid"></p>
<p>Besides properties, the <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=853"><code>in-for</code> loops</a> can additionally include this syntax to turn their returns into asynchronous results.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-Loops.png" alt="" class="img-fluid"></p>
<p>Some explanations and examples are pointed out hereafter to find out the potential areas of implementations of this syntax.</p>
<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active"
           data-bs-toggle="tab" 
           href="#AsyncAwaitExamples1"
           id="AsyncAwaitExamples1_tab"
           role="tab" 
           aria-selected="true">Example</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#AsyncAwaitExamples2"
           id="AsyncAwaitExamples2_tab"
           role="tab" 
           aria-selected="false">SyncContext</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#AsyncAwaitExamples3"
           id="AsyncAwaitExamples3_tab"
           role="tab" 
           aria-selected="false">Test</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#AsyncAwaitExamples4"
           id="AsyncAwaitExamples4_tab"
           role="tab" 
           aria-selected="false">Continuation</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#AsyncAwaitExamples5"
           id="AsyncAwaitExamples5_tab"
           role="tab" 
           aria-selected="false">Delegate</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#AsyncAwaitExamples6"
           id="AsyncAwaitExamples6_tab"
           role="tab" 
           aria-selected="false">AsyncThread</a>
    </li>
</ul>
<div class="tab-content">
<div class="tab-pane show active" id="AsyncAwaitExamples1" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=215">🎬</a></p>
<p>Instead of using the completion handlers, the <code>async-await</code> syntax brings about <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=510">less boilerplate code</a>.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-Example.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="AsyncAwaitExamples2" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=1326">🎬</a></p>
<p>Adding the <code>async-await</code> syntax in a synchronous context may lead to some troubles if some cautiousness isn't taken into account.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-ExampleSyncContext.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="AsyncAwaitExamples3" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=1280">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-ExamplesTesting.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="AsyncAwaitExamples4" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=1726">🎬</a></p>
<p>An excellent way to <strong>keep control over an async process</strong> relies on the <strong><a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=1126">continuation</a></strong> notion that involves some <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=1856">caveats</a> nevertheless.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-ExamplesContinuations_1.png" alt="" class="img-fluid"></p>
<p>The continuation has been introduced to replace the thread context switches for becoming the perfect place to <strong>insert the results from the completion handler</strong> using the <a href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=1787">withCheckedThrowingContinuation</a> method if any errors are taken into account (consider the <code>withCheckedContinuation</code> method otherwise).</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-ExamplesContinuations_2.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="AsyncAwaitExamples5" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10132/?time=1904">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-ExamplesDelegate.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="AsyncAwaitExamples6" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=879">🎬</a></p>
<p>This part details the design of the <code>await</code> language feature to guarantee the <strong>new suspension and resumption</strong> in Swift concurrency.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-AsyncAwait-ExamplesAsyncThread.png" alt="" class="img-fluid"></p>
</div>
</div>
</br></br>
<h2 id="tasks" class="h2-focus"><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=34">Tasks</a> <a class="header-anchor" href="#tasks" id="heading-1816" aria-labelledby="heading-1816">#</a></h2>
<p>This <strong>new feature in Swift</strong> is introduced through an <a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=111">example</a> to point out its special connection with the new <code>async/await</code> syntax based on structured programming.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-TasksIntro.png" alt="" class="img-fluid"></p>
<p><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=237">Tasks</a> are of <strong>four different types</strong> that are described in details hereafter.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-TasksOverview.png" alt="" class="img-fluid"></p>
<h3 id="async-let"><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=291">Async-let</a> <a class="header-anchor" href="#async-let" id="heading-1817" aria-labelledby="heading-1817">#</a></h3>
<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active"
           data-bs-toggle="tab" 
           href="#TasksAsyncLetOverview"
           id="TasksAsyncLetOverview_tab"
           role="tab" 
           aria-selected="true">Overview</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#TasksAsyncLetExample"
           id="TasksAsyncLetExample_tab"
           role="tab" 
           aria-selected="false">Example</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#TasksAsyncLetTaskTree"
           id="TasksAsyncLetTaskTree_tab"
           role="tab" 
           aria-selected="false">Task&nbsp;tree</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#TasksAsyncLetCancellation"
           id="TasksAsyncLetCancellation_tab"
           role="tab" 
           aria-selected="false">Cancellation</a>
    </li>
</ul>
<div class="tab-content">
<div class="tab-pane show active" id="TasksAsyncLetOverview" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=298">🎬</a></p>
<p>The async-let task is a <strong>concurrent binding</strong> whose evaluation is pretty much different from the usual let binding.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-AsyncLet_Overview.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="TasksAsyncLetExample" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=448">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-AsyncLet_Example.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="TasksAsyncLetTaskTree" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=519">🎬</a></p>
<p>The <strong>task tree</strong> is an <strong>integral part of the structured concurrency</strong> while providing a special environment to its elements (priorities, cancellation, inheritance...).</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-AsyncLet_Tasktree.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="TasksAsyncLetCancellation" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=656">🎬</a></p>
<p>Cancelling a task doesn't imply its complete cessation if it's already started but its results won't be needed anymore.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-AsyncLet_Cancellation.png" alt="" class="img-fluid"></p>
<p>Moreover, when this situation occurs, the cancelled task informs its potential subtasks of their cancellation as well.</p>
</div>
</div>
</br></br>
<h3 id="group"><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=773">Group</a> <a class="header-anchor" href="#group" id="heading-1818" aria-labelledby="heading-1818">#</a></h3>
<p>A task group is a form of structured concurrency that is designed to provide a dynamic amount of concurrency.</p>
<p>When a specific <strong>dynamic amount of concurency tasks</strong> is required, the task group is the type to be implemented using the <a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=838">withThrowingTaskgroup</a> function to <strong>ceate child tasks</strong> thanks to the group's async method.</p>
<p>An <a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=992">example</a> for downloading thumbnails highlights the new <code>for-await</code> loop to access an asynchronous sequence of values and explains the cancellation automation.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-TaskGroup.png" alt="" class="img-fluid"></p>
<p><strong>Manual cancellation of all tasks</strong> before exiting the block is also possible thanks to the <strong>cancelAll</strong> method applied to the group itself.</p>
<h3 id="unstructured"><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=1137">Unstructured</a> <a class="header-anchor" href="#unstructured" id="heading-1819" aria-labelledby="heading-1819">#</a></h3>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-UnstructuredOverview.png" alt="" class="img-fluid"></p>
<p>An interesting <a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=1197">example</a> is introduced to deliver an appropriate way to use this kind of task and to define the context in which it can be inserted.<br>
<img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-UnstructuredExample.png" alt="" class="img-fluid"></p>
<p><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=1333">Cancellation</a> for unstructured tasks isn't automatic and <strong>must be implemented</strong> to be taken into account.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-UnstructuredCancellation.png" alt="" class="img-fluid"></p>
<h3 id="detached"><a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=1403">Detached</a> <a class="header-anchor" href="#detached" id="heading-1820" aria-labelledby="heading-1820">#</a></h3>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-DetachedOverview.png" alt="" class="img-fluid"></p>
<p>The combination of the structured concurrency inside of a detached task is carried out in an <a href="https://developer.apple.com/videos/play/wwdc2021/10134/?time=1435">example</a> performing the creation of a group with no error returns by using the <code>withTaskGroup</code> method.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Tasks-DetachedExample.png" alt="" class="img-fluid"></p>
<h2 id="actors" class="h2-focus">Actors <a class="header-anchor" href="#actors" id="heading-1821" aria-labelledby="heading-1821">#</a></h2>
<p>Set up concurrent programs may lead to different situations pointed out in a basic counter example:</p>
<ol>
<li>
<p><a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=42">Data races</a> appear at first sight with a class object defining the counter.</p>
</li>
<li>
<p>Using <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=174">value semantics</a> instead of reference type brings about a new scenario that doesn't completely overcome the initial problem.</p>
</li>
<li>
<p>Finally, a <strong>new type</strong> comes in as <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=393">actor</a> to take advantage of synchronization with a shared mutable state and provide an appropriate solution for the previous downsides.</p>
</li>
</ol>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Actors_1.png" alt="" class="img-fluid"></p>
<p>This <strong><a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=321">new type</a></strong> reaches the Swift named types to provide another perspective for concurrently accessing data.<br>
<img src="../../../../../images/iOSdev/wwdc21-Concurrency-Actors_3.png" alt="" class="img-fluid"></p>
<p>The <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=282">actor properties</a> create a <strong>synchronization mechanism</strong> that is completely safe.<br>
<img src="../../../../../images/iOSdev/wwdc21-Concurrency-Actors_2.png" alt="" class="img-fluid"></p>
<p><strong>Using actors</strong> can only be done <strong>from within an asynchronous context</strong> and this interaction becomes <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=470">synchronous</a> when running on the actor itself.<br>
<img src="../../../../../images/iOSdev/wwdc21-Concurrency-Actors_4.png" alt="" class="img-fluid"></p>
<p>However, it's imperative to keep in mind that <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=542">successive calls</a> to a method handled by an actor element may lead to situations whose complete process must be managed to avoid useless operations and disappointed results.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-Actors_5.png" alt="" class="img-fluid"></p>
<p>Execution switching from one actor to another is called the <strong><a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=1852">actor hopping</a></strong> giving rise to the <strong><a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=2109">actor reentrancy</a></strong> notion that leads to a better scheduling and resource utilization.</p>
<p>Actors <strong>guarantee <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=1689">mutual exclusion</a></strong> while executing at most one method call at a time.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsMutualExclusion.png" alt="" class="img-fluid"></p>
<h3 id="isolation"><a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=797">Isolation</a> <a class="header-anchor" href="#isolation" id="heading-1822" aria-labelledby="heading-1822">#</a></h3>
<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active"
           data-bs-toggle="tab" 
           href="#ActorsIsolationProtocol"
           id="ActorsIsolationProtocol_tab"
           role="tab" 
           aria-selected="true">Protocol</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#ActorsIsolationClosure"
           id="ActorsIsolationClosure_tab"
           role="tab" 
           aria-selected="false">Closure</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#ActorsIsolationData"
           id="ActorsIsolationData_tab"
           role="tab" 
           aria-selected="false">Data</a>
    </li>
</ul>
<div class="tab-content">
<div class="tab-pane show active" id="ActorsIsolationProtocol" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=808">🎬</a></p>
<p>When conforming to a protocol that contains synchronous functions, an actor must prefix these overriden functions with the <strong>nonisolated</strong> keyword to be marked as an outside process that <strong>permits data races</strong> without referencing the mutable state on the actor.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationProtocol.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="ActorsIsolationClosure" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=933">🎬</a></p>
<p>Creating closures inside an actor <strong>doesn't imply a mandatory isolation</strong> to its context thanks to the <code>Task</code> model.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationClosure.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="ActorsIsolationData" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1027">🎬</a></p>
<p>Accessing classes through an actor may lead to data races though while <strong>structs ensures safety in concurrency</strong>.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationData.png" alt="" class="img-fluid"></p>
<p>Concurrently processing in a safe way is secured with elements of <strong>Sendable</strong> types.</p>
</div>
</div>
</br></br>
<h3 id="sendable">Sendable <a class="header-anchor" href="#sendable" id="heading-1823" aria-labelledby="heading-1823">#</a></h3>
<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item" role="presentation">
        <a class="nav-link active"
           data-bs-toggle="tab" 
           href="#ActorsIsolationSendableOverview"
           id="ActorsIsolationSendableOverview_tab"
           role="tab" 
           aria-selected="true">Overview</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#ActorsIsolationSendableCheck"
           id="ActorsIsolationSendableCheck_tab"
           role="tab" 
           aria-selected="false">Checking</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#ActorsIsolationSendableConformance"
           id="ActorsIsolationSendableConformance_tab"
           role="tab" 
           aria-selected="false">Conformance</a>
    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link"
           data-bs-toggle="tab" 
           href="#ActorsIsolationSendableFunction"
           id="ActorsIsolationSendableFunction_tab"
           role="tab" 
           aria-selected="false">Function</a>
    </li>
</ul>
<div class="tab-content">
<div class="tab-pane show active" id="ActorsIsolationSendableOverview" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1118">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationSendableOverview.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="ActorsIsolationSendableCheck" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1184">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationSendableCheck.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="ActorsIsolationSendableConformance" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1206">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationSendableConformance.png" alt="" class="img-fluid"></p>
</div>
<div class="tab-pane" id="ActorsIsolationSendableFunction" role="tabpanel">
<p><a alt="Click to playback the footage at the appropriate moment." href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1283">🎬</a></p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsIsolationSendableFunction.png" alt="" class="img-fluid"></p>
<p>It's important to notice that <code>@unchecked Sendable</code> can also be used for a class to stop the IDE warnings if the necessary dispatch queues have been implemented to ensure a safe concurrency in the appropriate functions.</p>
</div>
</div>
</br>
<h3 id="main-actor"><a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1408">Main actor</a> <a class="header-anchor" href="#main-actor" id="heading-1824" aria-labelledby="heading-1824">#</a></h3>
<p>Using the <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1496">@MainActor attribute</a> indicates that the examined element is <strong>working on the main thread</strong>.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsMainActor_1.png" alt="" class="img-fluid"></p>
<p>This <a href="https://developer.apple.com/videos/play/wwdc2021/10133/?time=1580">attribute on a specific type</a> ensures that its scope <strong>spreads all over the methods and properties</strong> of this type while giving the opportunity to get rid of it thanks to the <code>nonisolated</code> keyword.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsMainActor_2.png" alt="" class="img-fluid"></p>
<p>It may be also highly useful to modify the code structure in order to <a href="https://developer.apple.com/videos/play/wwdc2021/10254/?time=2233">avoid back and forth</a> between a thread and the main actor.</p>
<p><img src="../../../../../images/iOSdev/wwdc21-Concurrency-ActorsMainActor_3.png" alt="" class="img-fluid"><br>
</br></br></br></p>

          </div>
        </main>
        
          <div class="col-md-3">
            <div class="StickySideNavigation">
              <nav id="toc" class="bg-200 p-3 d-none d-md-block" role="navigation" aria-labelledby="toc-title">
      <h2 id="toc-title">On this page</h2>
      <ul class="nav flex-column"><li class="nav-item position-relative">
            <a href="#swift-concurrency" class="nav-link text-muted">Swift Concurrency</a></li><li class="nav-item position-relative">
            <a href="#async-await" class="nav-link text-muted">Async-await</a></li><li class="nav-item position-relative">
            <a href="#tasks" class="nav-link text-muted">Tasks</a>
            <ul><li class="nav-item position-relative">
            <a href="#async-let" class="nav-link text-muted">Async-let</a></li><li class="nav-item position-relative">
            <a href="#group" class="nav-link text-muted">Group</a></li><li class="nav-item position-relative">
            <a href="#unstructured" class="nav-link text-muted">Unstructured</a></li><li class="nav-item position-relative">
            <a href="#detached" class="nav-link text-muted">Detached</a></li></ul></li><li class="nav-item position-relative">
            <a href="#actors" class="nav-link text-muted">Actors</a>
            <ul><li class="nav-item position-relative">
            <a href="#isolation" class="nav-link text-muted">Isolation</a></li><li class="nav-item position-relative">
            <a href="#sendable" class="nav-link text-muted">Sendable</a></li><li class="nav-item position-relative">
            <a href="#main-actor" class="nav-link text-muted">Main actor</a></li></ul></li>
      </ul>
    </nav>
            </div>
          </div>
        
      </div>
    </div>
    

<footer id="footer" class="o-footer" role="contentinfo">
  <div class="container-lg">
    <nav class="py-2" role="navigation">
      <ul class="nav align-items-center flex-column flex-sm-row"><li class="nav-item">
            <a href="/en/contact/" class="nav-link">
  Contact
</a>
          </li><li class="nav-item">
            <a href="/en/about/" class="nav-link">
  About
</a>
          </li><li class="nav-item">
            <a href="/feed-en.xml" class="nav-link">
  RSS feed
</a>
          </li><li class="nav-item">
            <a href="/en/accessibility/" class="nav-link">
  Accessibility: partially compliant
</a>
          </li><li class="nav-item">
            <a href="https://a11y-guidelines-orange.netlify.app/en/" class="nav-link">
  Pre-release on Netlify
</a>
          </li><li class="nav-item">
          <a href="https://www.netlify.com" class="nav-link" title="Deploys by Netlify">
            <img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify" width="89" height="40">
          </a>
        </li>
        <li class="nav-item ms-sm-auto">
          <a href="https://github.com/Orange-OpenSource/a11y-guidelines/issues/new?title=File%20path%20:%20'./src/en/mobile/ios/wwdc/nota11y/2021/21AsyncConcurrency.md'" class="nav-link" rel="noopener noreferrer" target="_blank" title="Report an error on GitHub (new window)">
            Report an error on GitHub<span class="visually-hidden">&nbsp;(new window)</span><svg width="16" height="16" class="ms-1" viewBox="0 0 1000 1000" aria-hidden="true" focusable="false"><path class="cls-1" d="M374.908,308.958L600,309V109L921.719,430.9a74.988,74.988,0,0,1,0,106.044L600,859V659H325A150.027,150.027,0,0,0,175,809v81C98.941,830.528,50,737.929,50,633.891,50,454.436,195.466,308.958,374.908,308.958Z"/></svg>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</footer>

    <nav role="navigation" class="back-to-top" aria-label="Back to top">
      <a href="#top" class="back-to-top-link btn btn-icon btn-outline-secondary" title="Back to top">
        <span class="visually-hidden">Back to top</span>
      </a>
    </nav>
    <script src="/assets/vendors/tarteaucitronjs/tarteaucitron.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    
    
      <script src="https://cdn.jsdelivr.net/npm/boosted@5.3.3/dist/js/boosted.bundle.min.js" integrity="sha384-3RoJImQ+Yz4jAyP6xW29kJhqJOE3rdjuu9wkNycjCuDnGAtC/crm79mLcwj1w2o/" crossorigin="anonymous"></script>
    
    
      <script src="/assets/vendors/highlightjs/highlight.js"></script>
    
    <script>
      const Application = {
        lang: "en",
        vendors: {
          highlightJS: true,
          highlightTitle: false
        }
      }
    </script>
    <script src="/assets/script.js"></script><script>
      var tarteaucitronForceLanguage = "en"
      tarteaucitron.init({"privacyUrl":"","hashtag":"#cookie-consent","cookieName":"cookie-consent","orientation":"bottom","showAlertSmall":false,"cookieslist":true,"adblocker":false,"showIcon":false,"AcceptAllCta":true,"highPrivacy":true,"handleBrowserDNTRequest":false,"removeCredit":false,"moreInfoLink":true,"useExternalCss":true,"readmoreLink":"/cookiespolicy","mandatory":false});var dataLayer = [{
          'site_name': 'accessibility-guidelines',
          'phase': 'prod'
        }];
        tarteaucitron.user.googletagmanagerId = "GTM-N3M5VXS";
        (tarteaucitron.job = tarteaucitron.job || []).push('googletagmanager');docsearch({"appId":"QML88ZHQMQ","apiKey":"92e5543d97d72ef6a3ba61b241a75b19","indexName":"a11y-guidelines-orange","container":"#search-input","searchParameters":{"facetFilters":["language:en"]},"placeholder":"Search in entire website","translations":{"button":{"buttonText":"Search in entire website","buttonAriaLabel":"Search in entire website"},"modal":{"searchBox":{"resetButtonTitle":"Clear the query","resetButtonAriaLabel":"Clear the query","cancelButtonText":"Cancel","cancelButtonAriaLabel":"Cancel"},"startScreen":{"recentSearchesTitle":"Recent","noRecentSearchesText":"No recent searches","saveRecentSearchButtonTitle":"Save this search","removeRecentSearchButtonTitle":"Remove this search from history","favoriteSearchesTitle":"Favorite","removeFavoriteSearchButtonTitle":"Remove this search from favorites"},"errorScreen":{"titleText":"Unable to fetch results","helpText":"You might want to check your network connection."},"footer":{"selectText":"to select","selectKeyAriaLabel":"Enter key","navigateText":"to navigate","navigateUpKeyAriaLabel":"Arrow up","navigateDownKeyAriaLabel":"Arrow down","closeText":"to close","closeKeyAriaLabel":"Escape key","searchByText":"Search by"},"noResultsScreen":{"noResultsText":"No results for","suggestedQueryText":"Try searching for","reportMissingResultsText":"Believe this query should return results?","reportMissingResultsLinkText":"Let us know."}}},"debug":false});
    </script>
    <div hidden>Anchor link</div>
    <!--  This file is part of a11y-guidelines | Our vision of mobile & web accessibility guidelines and best practices, with valid/invalid examples. Copyright (C) 2016 - 2025 Orange SA. See the Creative Commons Legal Code Attribution-ShareAlike 3.0 Unported License for more details (LICENCE file). -->

  </body>
</html>
